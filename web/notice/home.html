<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>çœ‹è¨ºæé†’ğŸ’Œ</title>
<link rel="manifest" href="manifest.json">	
<link href="static/img/icon_192.png" rel="shortcut icon">

<link rel="Bookmark" href="static/img/favicon.ico"/>
    
<link rel="icon" sizes="192x192" href="static/img/icon_192.png">
<link rel="icon" sizes="128x128" href="static/img/icon_128.png">
<link rel="apple-touch-icon" sizes="128x128" href="static/img/icon_128.png">
<link rel="apple-touch-icon-precomposed" sizes="128x128" href="static/img/icon_128.png">

</head>
    <script>
    // æ”¯æ´serviceWorkeræ‰å­˜å…¥sw.jsæª”
    if('serviceWorker' in navigator) {
      
      // window loadå¾Œæ‰åŸ·è¡Œï¼Œä»¥å…å¢åŠ é é¢è®€å–çš„æ™‚é–“
      window.addEventListener('load', function() {
        
        // å»ºç«‹sw.js
        navigator.serviceWorker.register('https://hosp-nckm.github.io/web/notice/sw.js')
          .then(function(reg) {
            console.log(reg.scope); // çœ‹é€™æ”¯sw.jsåŸ·è¡Œçš„ç¯„åœ
          })
          // è¨»å†Šå¤±æ•—
          .catch(function(err) {
            console.log('error: ', err);
          });
       
        // é™„ä¸Šåˆªé™¤sw.jsçš„å¯«æ³•
        /*navigator.serviceWorker.getRegistrations().then(function(reg) {
          for(var reg of reg) {
            reg.unregister()
          }
        });*/
        
      });
    }
  </script>
<!--script>
this.addEventListener('fetch', function(event) {
  event.respondWith(
    caches.match(event.request).then(function (response) {
		  return response;
    })
  );
}); 
</script-->
<script>
    self.addEventListener('fetch', event => {
	const dataUrl = 'https://hosp-nckm.github.io/web/notice/';
	event.respondWith(
		caches.match(event.request).then(function (response) {
			return response || fetch(event.request).then(res =>
				// å­˜ caches ä¹‹å‰ï¼Œè¦å…ˆæ‰“é–‹ caches.open(dataCacheName)
				caches.open(dataCacheName)
				.then(function(cache) {
					// cache.put(key, value)
					// ä¸‹ä¸€æ¬¡ caches.match æœƒå°æ‡‰åˆ° event.request
					cache.put(event.request, res.clone());
					return res;
				})
			);
		})
	);
}); 
</script>
<script>
	// æŸ¥çœ‹ä½¿ç”¨è€…è¨±å¯æ¬Š
	if(Notification.permission === 'granted'){
		console.log('ä½¿ç”¨è€…å…è¨±é€šçŸ¥');
	}else if(Notification.permission === 'denied'){
		console.log('ä½¿ç”¨è€…æ‹’çµ•é€šçŸ¥');
	}else{
		console.log('ä½¿ç”¨è€…é‚„æ²’é¸æ“‡ï¼Œå»å‘ä½¿ç”¨è€…ç”³è«‹è¨±å¯æ¬Šå§');
	}
	
	// è«‹æ±‚è¨±å¯æ¬Š
	Notification.requestPermission().then(function(permission) {
	if(permission === 'granted'){
		console.log('ä½¿ç”¨è€…å…è¨±é€šçŸ¥');
	}else if(permission === 'denied'){
		console.log('ä½¿ç”¨è€…æ‹’çµ•é€šçŸ¥');
	}
	});
	
	// æ¨é€é€šçŸ¥
	var notification = new Notification(title, options)
	// é€šçŸ¥è¨Šæ¯
	var n = new Notification('ç‹€æ…‹æ›´æ–°æé†’',{
		body: 'ä½ çš„æœ‹å‹åœˆæœ‰3æ¢æ–°ç‹€æ…‹ï¼Œå¿«å»æª¢è¦–å§',
		tag: 'linxin',
		icon: 'https://codertw.com/wp-content/uploads/2018/05/20180527144122-5b0ac39228361.jpg',
		requireInteraction: true
	})
	
	// é—œé–‰é€šçŸ¥
	var n = new Notification('ç‹€æ…‹æ›´æ–°æé†’',{
		body: 'ä½ çš„æœ‹å‹åœˆæœ‰3æ¢æ–°ç‹€æ…‹ï¼Œå¿«å»æª¢è¦–å§'
	})
	setTimeout(function() {
		n.close();
	}, 3000);
	
</script>
<body>
    <h1>çœ‹è¨ºæé†’</h1>
    <p>çœ‹è¨ºæé†’é€šçŸ¥</p>
  
</body>
</html>
