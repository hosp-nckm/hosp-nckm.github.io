<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>çœ‹è¨ºæé†’1ğŸ’Œ</title>
<link rel="manifest" href="manifest.json">	
<link href="static/img/icon_192.png" rel="shortcut icon">

<link rel="Bookmark" href="static/img/favicon.ico"/>
    
<link rel="icon" sizes="192x192" href="static/img/icon_192.png">
<link rel="icon" sizes="128x128" href="static/img/icon_128.png">
<link rel="apple-touch-icon" sizes="128x128" href="static/img/icon_128.png">
<link rel="apple-touch-icon-precomposed" sizes="128x128" href="static/img/icon_128.png">

</head>
    <script>
    // æ”¯æ´serviceWorkeræ‰å­˜å…¥sw.jsæª”
    if('serviceWorker' in navigator) {
      
      // window loadå¾Œæ‰åŸ·è¡Œï¼Œä»¥å…å¢åŠ é é¢è®€å–çš„æ™‚é–“
      window.addEventListener('load', function() {
        
        // å»ºç«‹sw.js
        navigator.serviceWorker.register('https://hosp-nckm.github.io/web/notice/sw.js')
          .then(function(reg) {
            console.log(reg.scope); // çœ‹é€™æ”¯sw.jsåŸ·è¡Œçš„ç¯„åœ
          })
          // è¨»å†Šå¤±æ•—
          .catch(function(err) {
            console.log('error: ', err);
          });
       
        // é™„ä¸Šåˆªé™¤sw.jsçš„å¯«æ³•
        /*navigator.serviceWorker.getRegistrations().then(function(reg) {
          for(var reg of reg) {
            reg.unregister()
          }
        });*/
        
      });
    }
  </script>
<!--script>
this.addEventListener('fetch', function(event) {
  event.respondWith(
    caches.match(event.request).then(function (response) {
		  return response;
    })
  );
}); 
</script-->
<script>
    self.addEventListener('fetch', event => {
	const dataUrl = 'https://hosp-nckm.github.io/web/notice/';
	event.respondWith(
		caches.match(event.request).then(function (response) {
			return response || fetch(event.request).then(res =>
				// å­˜ caches ä¹‹å‰ï¼Œè¦å…ˆæ‰“é–‹ caches.open(dataCacheName)
				caches.open(dataCacheName)
				.then(function(cache) {
					// cache.put(key, value)
					// ä¸‹ä¸€æ¬¡ caches.match æœƒå°æ‡‰åˆ° event.request
					cache.put(event.request, res.clone());
					return res;
				})
			);
		})
	);
}); 
</script>
<script>
	/*// æŸ¥çœ‹ä½¿ç”¨è€…è¨±å¯æ¬Š
	if(Notification.permission === 'granted'){
		console.log('ä½¿ç”¨è€…å…è¨±é€šçŸ¥');
	}else if(Notification.permission === 'denied'){
		console.log('ä½¿ç”¨è€…æ‹’çµ•é€šçŸ¥');
	}else{
		console.log('ä½¿ç”¨è€…é‚„æ²’é¸æ“‡ï¼Œå»å‘ä½¿ç”¨è€…ç”³è«‹è¨±å¯æ¬Šå§');
	}
	
	// è«‹æ±‚è¨±å¯æ¬Š
	Notification.requestPermission().then(function(permission) {
	if(permission === 'granted'){
		console.log('ä½¿ç”¨è€…å…è¨±é€šçŸ¥');
	}else if(permission === 'denied'){
		console.log('ä½¿ç”¨è€…æ‹’çµ•é€šçŸ¥');
	}
	});
	
	// æ¨é€é€šçŸ¥
	title="çœ‹è¨ºæé†’é€šçŸ¥1";
	
	var notification = new Notification(title)
	// é€šçŸ¥è¨Šæ¯
	var n = new Notification('çœ‹è¨ºæé†’é€šçŸ¥1',{
		body: 'ä½ çœ‹è¨ºæé†’é€šçŸ¥æ¸¬è©¦1ï¼Œè«‹å¿½ç•¥',
		tag: 'a',
		icon: 'static/img/icon_128.png',
		requireInteraction: true
	})
	
	// é—œé–‰é€šçŸ¥
	var n = new Notification('çœ‹è¨ºæé†’é€šçŸ¥1',{
		body: 'ä½ çœ‹è¨ºæé†’é€šçŸ¥æ¸¬è©¦1ï¼Œè«‹å¿½ç•¥'
	})
	setTimeout(function() {
		n.close();
	}, 3000);*/
  
  // æª¢æŸ¥ç€è¦½å™¨æ˜¯å¦æ”¯æ´é€šçŸ¥
  if (!('Notification' in window)) {
  alert('This browser does not support notification');
}
  // è«‹æ±‚æˆæ¬Š
  if (Notification.permission === 'default' || Notification.permission === 'undefined') {
  Notification.requestPermission(function(permission) {
    // permission å¯ç‚ºã€Œgrantedã€ï¼ˆåŒæ„ï¼‰ã€ã€Œdeniedã€ï¼ˆæ‹’çµ•ï¼‰å’Œã€Œdefaultã€ï¼ˆæœªæˆæ¬Šï¼‰
    // åœ¨é€™è£¡å¯é‡å°ä½¿ç”¨è€…çš„æˆæ¬Šåšè™•ç†
  });
}
  
   // å»ºç«‹é€šçŸ¥
  var notifyConfig = {
  body: '\\ ^o^ /', // è¨­å®šå…§å®¹
  icon: 'static/img/favicon.ico', // è¨­å®š icon
  tag: 'newFeature' // è¨­å®šæ¨™ç±¤
};
 
if (Notification.permission === 'default' || Notification.permission === 'undefined') {
  Notification.requestPermission(function(permission) {
    if (permission === 'granted') {
      // ä½¿ç”¨è€…åŒæ„æˆæ¬Š
      var notification = new Notification('çœ‹è¨ºå’¯ï¼', notifyConfig); // å»ºç«‹é€šçŸ¥      
      alert("ä½¿ç”¨è€…åŒæ„");
      
      // é»æ“Šé€šçŸ¥
      notification.onclick = function(e) { // ç¶å®šé»æ“Šäº‹ä»¶
      e.preventDefault(); // prevent the browser from focusing the Notification's tab
      window.open('https://hosp-nckm.github.io/web/%E7%B2%89%E7%B4%85%E6%97%85%E7%A8%8B/home.html'); // æ‰“é–‹ç‰¹å®šç¶²é 
      }
      
      // éŒ¯èª¤è™•ç†
      notification.onerror = function(e) {
        alert("æœ‰error");// error handling
      };
    }
  });
}
	
</script>
<body>
    <h1>çœ‹è¨ºæé†’2</h1>
    <p>çœ‹è¨ºæé†’é€šçŸ¥2</p>
  
</body>
</html>
